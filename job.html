<!DOCTYPE html>
<html>
  <head>
     <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GMD Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;600;700&display=swap" rel="stylesheet">
    <style>
  #task-list {
  width: 100%;
  max-width: 500px;
}

  #task {
  color: #34d399;
}

.task-card {
  background: rgba(255, 255, 255, 0.05);
  backdrop-filter: blur(15px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.6);
  margin-bottom: 2rem;
  margin-top: 2rem;
  display: flex;
  flex-direction: column;
}

.task-video {
  width: 100%;
  height: auto;
  max-height: 280px;
  object-fit: cover;
  background: #000;
}

.task-comments {
  padding: 1rem;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.task-comments h3 {
  margin-bottom: 0.5rem;
  font-size: 1.1rem;
  font-weight: 600;
  color: #f1f1f1;
}

.task-comments ul {
  list-style: none;
  padding: 0;
  margin: 0;
  max-height: 150px;
  overflow-y: auto;
}

.task-comments li {
  padding: 0.6rem;
  margin-bottom: 0.5rem;
  background-color: rgba(255, 255, 255, 0.07);
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.task-comments li:hover {
  background-color: rgba(255, 255, 255, 0.15);
}

.earn-button {
  background: linear-gradient(135deg, #ff416c, #ff4b2b);
  border: none;
  padding: 1rem;
  color: white;
  font-size: 1rem;
  font-weight: bold;
  border-radius: 0 0 16px 16px;
  cursor: pointer;
  transition: background 0.3s ease;
}

.earn-button:hover {
  background: linear-gradient(135deg, #ff4b2b, #ff416c);
}
   body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: 
        linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.6)), 
        url('https://wallpaperaccess.com/full/3047700.jpg') no-repeat center center fixed;
      background-size: cover;
      color: var(--text-main);
      padding: 20px;
    }
     h2 {
  color: #34d399; /* Tailwind emerald-400 / green tone */
}

#earnings {
  color: #34d399;
  font-weight: bold;
}
.task-title, .earnings-display, .level-status,
#task-status {
  color: #34d399; /* Tailwind green-400 */
  font-weight: bold;
}

</style>
  </head>
  <body>
  <h2 class="task-title">🎬 Watch & Earn Tasks</h2>
  <div class="level-status">
    Task Available: <span id="task-status">Yes</span>
  </div>
   
  <div id="task-list">
    <!-- Task Card 1 -->
    <div class="task-card">
      <video src="1000032062.mp4" controls class="task-video"></video>
      <div class="task-comments">
        <h3>Comments</h3>
        <ul>
          <li onclick="handleCommentClick(this)">👍 Great content, very engaging!</li>
          <li onclick="handleCommentClick(this)">👎 The audio quality could be better.</li>
          <li onclick="handleCommentClick(this)">🔥 Loved the editing style and pace!</li>
          <li onclick="handleCommentClick(this)">🤔 It felt a bit too long for the main point.</li>
        </ul>
      </div>
      <button class="earn-button" onclick="completeTask(this)">Mark as Watched</button>
    </div>

    <!-- Task Card 2 -->
    <div class="task-card">
      <video src="1000032063.mp4"task-video"></video>
      <div class="task-comments">
        <h3>Comments</h3>
        <ul>
          <li onclick="handleCommentClick(this)">🌟 Informative and well-structured.</li>
          <li onclick="handleCommentClick(this)">😐 Not really my type of content.</li>
          <li onclick="handleCommentClick(this)">✅ Clear message and visuals.</li>
          <li onclick="handleCommentClick(this)">❗️Could’ve used subtitles.</li>
        </ul>
      </div>
      <button class="earn-button" onclick="completeTask(this)">Mark as Watched</button>
    </div>

    <!-- Task Card 3 -->
    <div class="task-card">
      <video src="1000032064.mp4" controls class="task-video"></video>
      <div class="task-comments">
        <h3>Comments</h3>
        <ul>
          <li onclick="handleCommentClick(this)">🎥 Very cinematic feel!</li>
          <li onclick="handleCommentClick(this)">🚫 Didn’t understand the main point.</li>
          <li onclick="handleCommentClick(this)">🎶 Loved the background music.</li>
          <li onclick="handleCommentClick(this)">💬 Could use clearer captions.</li>
        </ul>
      </div>
      <button class="earn-button" onclick="completeTask(this)">Mark as Watched</button>
    </div>
  </div>

    <!-- Task Card 4 -->
    <div class="task-card">
      <video src="1000032065.mp4" controls class="task-video"></video>
      <div class="task-comments">
        <h3>Comments</h3>
        <ul>
          <li onclick="handleCommentClick(this)">🌟 Informative and well-structured.</li>
          <li onclick="handleCommentClick(this)">😐 Not really my type of content.</li>
          <li onclick="handleCommentClick(this)">✅ Clear message and visuals.</li>
          <li onclick="handleCommentClick(this)">❗️Could’ve used subtitles.</li>
        </ul>
      </div>
      <button class="earn-button" onclick="completeTask(this)">Mark as Watched</button>
    </div>

    <!-- Task Card 5 -->
    <div class="task-card">
      <video src="1000032066.mp4" controls class="task-video"></video>
      <div class="task-comments">
        <h3>Comments</h3>
        <ul>
          <li onclick="handleCommentClick(this)">👍 Great content, very engaging!</li>
          <li onclick="handleCommentClick(this)">👎 The audio quality could be better.</li>
          <li onclick="handleCommentClick(this)">🔥 Loved the editing style and pace!</li>
          <li onclick="handleCommentClick(this)">🤔 It felt a bit too long for the main point.</li>
        </ul>
      <button class="earn-button" onclick="completeTask(this)">Mark as Watched</button>
    </div>
    
     <!-- Task Card 5 -->
    <div class="task-card">
      <video src="1000032067.mp4" controls class="task-video"></video>
      <div class="task-comments">
        <h3>Comments</h3>
        <ul>
          <li onclick="handleCommentClick(this)">🌟 Informative and well-structured.</li>
          <li onclick="handleCommentClick(this)">😐 Not really my type of content.</li>
          <li onclick="handleCommentClick(this)">✅ Clear message and visuals.</li>
          <li onclick="handleCommentClick(this)">❗️Could’ve used subtitles.</li>
        </ul>
      </div>
      <button class="earn-button" onclick="completeTask(this)">Mark as Watched</button>
    </div>
    <!-- Task Card 6 -->
    <div class="task-card">
      <video src="1000032091.mp4" controls class="task-video"></video>
      <div class="task-comments">
        <h3>Comments</h3>
         <ul>
          <li onclick="handleCommentClick(this)">🎥 Very cinematic feel!</li>
          <li onclick="handleCommentClick(this)">🚫 Didn’t understand the main point.</li>
          <li onclick="handleCommentClick(this)">🎶 Loved the background music.</li>
          <li onclick="handleCommentClick(this)">💬 Could use clearer captions.</li>
        </ul>
      </div>
      <button class="earn-button" onclick="completeTask(this)">Mark as Watched</button>
    </div>

    <!-- Task Card 7 -->
    <div class="task-card">
      <video src="1000032092.mp4" controls class="task-video"></video>
      <div class="task-comments">
        <h3>Comments</h3>
        <ul>
          <li onclick="handleCommentClick(this)">🌟 Informative and well-structured.</li>
          <li onclick="handleCommentClick(this)">😐 Not really my type of content.</li>
          <li onclick="handleCommentClick(this)">✅ Clear message and visuals.</li>
          <li onclick="handleCommentClick(this)">❗️Could’ve used subtitles.</li>
        </ul>
      </div>
      <button class="earn-button" onclick="completeTask(this)">Mark as Watched</button>
    </div>

        <!-- Task Card 8 -->
    <div class="task-card">
      <img src="https://o2tvseries.xyz/wp-content/uploads/2025/05/Soul-to-Squeeze_Poster-326x245.jpg" controls class="task-video"></img>
      <div class="task-comments">
        <h3>Comments</h3>
        <ul>
          <li onclick="handleCommentClick(this)">👍 Nice one, very engaging!</li>
          <li onclick="handleCommentClick(this)">👎😑 I think the graphics is quiet.</li>
          <li onclick="handleCommentClick(this)">🔥 Loved the editing style and pace!</li>
          <li onclick="handleCommentClick(this)">🤔 Needs more Improvement.</li>
        </ul>
      </div>
      <button class="earn-button" onclick="completeTask(this)">Mark as Watched</button>
    </div>

  <!-- Task Card 9 -->
    <div class="task-card">
      <img src="https://o2tvseries.xyz/wp-content/uploads/2025/05/Rosario_Poster-326x245.jpg"></img>
      <div class="task-comments">
        <h3>Comments</h3>
        <ul>
          <li onclick="handleCommentClick(this)">👍 Nice one, very engaging!</li>
          <li onclick="handleCommentClick(this)">👎😑 I think the graphics is quiet.</li>
          <li onclick="handleCommentClick(this)">🔥 Loved the editing style and pace!</li>
          <li onclick="handleCommentClick(this)">🤔 Needs more Improvement.</li>
        </ul>
      </div>
      <button class="earn-button" onclick="completeTask(this)">Mark as Watched</button>
    </div>
      
      <!-- Task Card 10 -->
    <div class="task-card">
      <img src="https://o2tvseries.xyz/wp-content/uploads/2025/05/Depart-from-It_Poster-326x245.jpg"></img>
      <div class="task-comments">
        <h3>Comments</h3>
        <ul>
          <li onclick="handleCommentClick(this)">👍 Nice one, very engaging!</li>
          <li onclick="handleCommentClick(this)">👎😑 I think the graphics is quiet.</li>
          <li onclick="handleCommentClick(this)">🔥 Loved the editing style and pace!</li>
          <li onclick="handleCommentClick(this)">🤔 Needs more Improvement.</li>
        </ul>
      </div>
      <button class="earn-button" onclick="completeTask(this)">Mark as Watched</button>
    </div>
  <div class="earnings-display">
    🪙 Earnings: $<span id="earnings">0.00</span>
  </div>
<script type="module">
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

const supabaseUrl = 'https://spztajjxtruxxtonqiko.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNwenRhamp4dHJ1eHh0b25xaWtvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgyOTk5NzAsImV4cCI6MjA2Mzg3NTk3MH0.2Ik67UPP_mY662xbtWR6g0QncLT_9fHRQb1NCveIDRY';
const supabase = createClient(supabaseUrl, supabaseKey);

const earningsDisplay = document.getElementById('earnings');
const taskStatus = document.getElementById('task-status');
const userId = localStorage.getItem('user_id');
const buttons = document.querySelectorAll('.earn-button');

let completedTasks = 0;
let taskLockedUntil = null;
let earnings = 0;

// Load existing task lock state
const loadTaskLock = async () => {
  if (!userId) return;

  const { data, error } = await supabase
    .from('users')
    .select('last_task_completed_at')
    .eq('user_id', userId)
    .single();

  const now = new Date();
  if (data?.last_task_completed_at) {
    const last = new Date(data.last_task_completed_at);
    const diff = now - last;
    if (diff < 86400000) {
      taskLockedUntil = new Date(last.getTime() + 86400000);
      lockTasks('⏳ You must wait 24h to earn again.');
      return;
    }
  }

  // Check if today is Sunday (0 = Sunday)
  if (now.getDay() === 0) {
    lockTasks('⛔ Tasks unavailable on Sundays.');
  }
};

// Lock all tasks and show a message
const lockTasks = (message) => {
  buttons.forEach(btn => {
    btn.disabled = true;
    btn.innerText = message;
    btn.classList.add('locked');
  });
  if (taskStatus) taskStatus.textContent = message;
};

// Complete a task
const completeTask = async (button) => {
  const now = new Date();
  if (now.getDay() === 0) {
    alert('⛔ Tasks are not available on Sundays.');
    return;
  }

  if (taskLockedUntil && now < taskLockedUntil) {
    alert('⏳ You must wait 24 hours before doing another task.');
    return;
  }

  if (button.disabled) return;

  completedTasks++;
  earnings += 0.9;
  button.disabled = true;
  button.innerText = '✅ Completed';
  button.classList.add('completed');
  earningsDisplay.textContent = `+${earnings.toFixed(2)} USDT`;
  earningsDisplay.style.color = 'green';

  if (userId) {
    await supabase.rpc('add_earnings_to_balance', {
      user_id_input: userId,
      amount_input: 0.9
    });
  }

  if (completedTasks >= 3) {
    const nowISO = new Date().toISOString();
    await supabase.from('users').update({
      last_task_completed_at: nowISO
    }).eq('user_id', userId);

    taskLockedUntil = new Date(Date.now() + 86400000);
    lockTasks('✅ Task limit reached. Come back in 24 hours.');
    alert('✅ Task limit reached. Come back in 24 hours.');
  }
};
  
// Allow use from buttons
window.completeTask = completeTask;

// Run check on load
loadTaskLock();
</script>
  </body>
</html>
